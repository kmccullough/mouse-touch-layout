{"version":3,"sources":["../src/index.js"],"names":["UsingTouchLayout","constructor","classElement","document","body","eventElement","onTouchActive","onNonTouchActive","onChange","nonTouchActiveClass","touchActiveClass","navigator","maxTouchPoints","setClasses","onTouchActiveChange","pointerEvent","onPointerDown","e","pointerType","isTouchActive","addEventListener","cleanUps","push","removeEventListener","isDestroyed","add","remove","classList","hasNonTouchActiveClass","hasTouchActiveClass","destroy","forEach","c"],"mappings":"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","sourcesContent":["export class UsingTouchLayout {\n\n  isTouchActive = !!navigator?.maxTouchPoints;\n\n  nonTouchActiveClass = 'l-using-touch--non-touch';\n  touchActiveClass = 'l-using-touch--touch';\n\n  cleanUps = [];\n\n  classElement;\n  isDestroyed = false;\n\n  constructor({\n      classElement = document?.body,\n      eventElement = document,\n      onTouchActive = () => {},\n      onNonTouchActive = () => {},\n      onChange = () => {},\n      nonTouchActiveClass,\n      touchActiveClass,\n    } = {}\n  ) {\n    this.classElement = classElement;\n    this.setClasses(nonTouchActiveClass, touchActiveClass)\n      || this.onTouchActiveChange();\n    const pointerEvent = 'pointerdown';\n    const onPointerDown = e => {\n      if (e.pointerType === 'touch') {\n        if (!this.isTouchActive) {\n          this.isTouchActive = true;\n          this.onTouchActiveChange();\n          onTouchActive();\n          onChange(true);\n        }\n      } else if (this.isTouchActive) {\n        this.isTouchActive = false;\n        this.onTouchActiveChange();\n        onNonTouchActive();\n        onChange(false);\n      }\n    };\n    eventElement.addEventListener(pointerEvent, onPointerDown);\n    this.cleanUps.push(() => eventElement.removeEventListener(pointerEvent, onPointerDown));\n  }\n\n  onTouchActiveChange() {\n    if (this.isDestroyed) {\n      return;\n    }\n    let { isTouchActive, nonTouchActiveClass: add, touchActiveClass: remove } = this;\n    if (isTouchActive) {\n      [ add, remove ] = [ remove, add ];\n    }\n    const { classList } = this.classElement;\n    classList.remove(remove);\n    classList.add(add);\n  }\n\n  setClasses(nonTouchActiveClass = this.nonTouchActiveClass, touchActiveClass = this.touchActiveClass) {\n    if (this.isDestroyed) {\n      return false;\n    }\n    const hasNonTouchActiveClass = nonTouchActiveClass !== this.nonTouchActiveClass;\n    const hasTouchActiveClass = touchActiveClass !== this.touchActiveClass;\n    if (!(hasNonTouchActiveClass || hasTouchActiveClass)) {\n      return false;\n    }\n    const { classList } = this.classElement;\n    if (hasNonTouchActiveClass) {\n      classList.remove(this.nonTouchActiveClass);\n      this.nonTouchActiveClass = nonTouchActiveClass;\n    }\n    if (hasTouchActiveClass) {\n      classList.remove(this.touchActiveClass);\n      this.touchActiveClass = touchActiveClass;\n    }\n    this.onTouchActiveChange();\n    return true;\n  }\n\n  destroy() {\n    if (this.isDestroyed) {\n      return;\n    }\n    this.cleanUps.forEach(c => c());\n    this.isDestroyed = true;\n  }\n\n}\n"],"file":"index.js"}